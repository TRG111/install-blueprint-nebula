#!/bin/bash

# ==========================
# PrimeTRG Nebula Installer
# ==========================

# Function for animation
animate_title() {
    TITLE="PrimeTRG"
    for ((i=0; i<${#TITLE}; i++)); do
        echo -n "${TITLE:$i:1}"
        sleep 0.1
    done
    echo -e "\n"
}

# Function to install nebula theme
install_nebula() {
    echo "Starting Nebula installation..."
    
    # Core install commands
    git clone https://github.com/username5642/nebula.git
    cd nebula || exit
    bash install.gg

    echo "Installing dependencies..."
    sudo apt-get install -y ca-certificates curl gnupg
    sudo mkdir -p /etc/apt/keyrings
    curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg
    echo "deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_20.x nodistro main" | sudo tee /etc/apt/sources.list.d/nodesource.list
    sudo apt-get update
    sudo apt-get install -y nodejs
    npm i -g yarn
    cd /var/www/pterodactyl || exit
    yarn
    sudo apt install -y zip unzip git curl wget
    wget "$(curl -s https://api.github.com/repos/BlueprintFramework/framework/releases/latest | grep 'browser_download_url' | cut -d '"' -f 4)" -O release.zip
    mv release.zip /var/www/pterodactyl/release.zip
    cd /var/www/pterodactyl || exit
    unzip release.zip
    touch /var/www/pterodactyl/.blueprintrc
    echo 'WEBUSER="www-data";
OWNERSHIP="www-data:www-data";
USERSHELL="/bin/bash";' >> /var/www/pterodactyl/.blueprintrc
    chmod +x blueprint.sh
    bash blueprint.sh
    blueprint -install nebula

    echo "Nebula installation completed!"
}

# Main script
clear
animate_title

echo "Select an option:"
echo "1. Install Your Nebula Theme"
echo "2. Exit"
read -rp "Enter choice [1-2]: " choice

case $choice in
    1)
        install_nebula
        ;;
    2)
        echo "Exiting..."
        exit 0
        ;;
    *)
        echo "Invalid choice!"
        exit 1
        ;;
esac
